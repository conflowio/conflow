// Code generated by Basil. DO NOT EDIT.
package strings

import (
	"fmt"

	"github.com/opsidian/basil/basil"
	"github.com/opsidian/basil/basil/variable"
	"github.com/opsidian/parsley/parsley"
)

// ReplaceInterpreter is an AST node interpreter for the Replace function
type ReplaceInterpreter struct{}

// StaticCheck runs a static analysis on the function parameters
func (i ReplaceInterpreter) StaticCheck(ctx interface{}, node basil.FunctionNode) (string, parsley.Error) {
	if len(node.ArgumentNodes()) != 3 {
		return "", parsley.NewError(node.Pos(), fmt.Errorf("%s expects 3 arguments", node.Name()))
	}

	arguments := node.ArgumentNodes()

	if err := variable.CheckNodeType(arguments[0], "string"); err != nil {
		return "", err
	}

	if err := variable.CheckNodeType(arguments[1], "string"); err != nil {
		return "", err
	}

	if err := variable.CheckNodeType(arguments[2], "string"); err != nil {
		return "", err
	}

	return "string", nil

}

// Eval returns with the result of the function
func (i ReplaceInterpreter) Eval(ctx interface{}, node basil.FunctionNode) (interface{}, parsley.Error) {
	arguments := node.ArgumentNodes()

	arg0, evalErr := arguments[0].Value(ctx)
	if evalErr != nil {
		return nil, evalErr
	}

	val0, convertErr := variable.StringValue(arg0)
	if convertErr != nil {
		return nil, parsley.NewError(arguments[0].Pos(), convertErr)
	}

	arg1, evalErr := arguments[1].Value(ctx)
	if evalErr != nil {
		return nil, evalErr
	}

	val1, convertErr := variable.StringValue(arg1)
	if convertErr != nil {
		return nil, parsley.NewError(arguments[1].Pos(), convertErr)
	}

	arg2, evalErr := arguments[2].Value(ctx)
	if evalErr != nil {
		return nil, evalErr
	}

	val2, convertErr := variable.StringValue(arg2)
	if convertErr != nil {
		return nil, parsley.NewError(arguments[2].Pos(), convertErr)
	}

	return Replace(
		val0,
		val1,
		val2,
	), nil

}
